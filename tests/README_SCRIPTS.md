# Transaction Generator Scripts

Collection of bash scripts to generate sample transactions for testing and demo purposes.

## Available Scripts

### 1. `generate_transactions.sh` - Comprehensive Transaction Generator
Generates 10 predefined transactions with various product combinations.

**Usage:**
```bash
bash tests/generate_transactions.sh [BASE_URL]
```

**Default:** `http://localhost:8080`

**Features:**
- Creates 10 different transaction scenarios
- Shows success/failure count
- Displays today's report after completion
- Shows recent transactions

**Example:**
```bash
# Generate transactions on local server
bash tests/generate_transactions.sh

# Generate transactions on remote server
bash tests/generate_transactions.sh http://production-server:8080
```

**Output:**
```
==========================================
  Generating Sample Transactions
==========================================
Base URL: http://localhost:8080
Target: 10 transactions

[1/10] Creating transaction: 1x Laptop
  âœ“ SUCCESS - Transaction ID: 8, Total: Rp 6000000

...

Total Attempted: 10
Successful:      10
Failed:          0
```

---

### 2. `quick_transactions.sh` - Quick Sample Transactions
Creates 3 quick sample transactions for rapid testing.

**Usage:**
```bash
bash tests/quick_transactions.sh [BASE_URL]
```

**Features:**
- Fast execution (3 transactions)
- Mixed product orders
- Shows today's report

**Example:**
```bash
bash tests/quick_transactions.sh
```

---

### 3. `smart_transactions.sh` - Smart Random Transaction Generator
Creates random transactions based on available stock.

**Usage:**
```bash
bash tests/smart_transactions.sh [BASE_URL] [COUNT]
```

**Parameters:**
- `BASE_URL`: API base URL (default: `http://localhost:8080`)
- `COUNT`: Number of transactions to generate (default: `5`)

**Features:**
- Checks stock before generating
- Random product selection
- Avoids products with zero stock
- Shows stock levels after transactions

**Example:**
```bash
# Generate 5 random transactions
bash tests/smart_transactions.sh

# Generate 20 random transactions
bash tests/smart_transactions.sh http://localhost:8080 20
```

**Output:**
```
==========================================
  Smart Transaction Generator
==========================================

Available products:
  - [3] Tablet: Rp 3000000 (Stock: 7)
  - [4] Headphones: Rp 300000 (Stock: 30)
  ...

[1/5] Creating: 2 x Headphones
  âœ“ Transaction #19 - Total: Rp 600000
...

ðŸ“Š Today's Report:
{
  "total_revenue": 144702298,
  "total_transaksi": 21,
  "produk_terlaris": {
    "nama": "Headphones",
    "qty_terjual": 34
  }
}
```

---

## Prerequisites

All scripts require:
- Running kasir-app server
- `curl` command
- `jq` command (for JSON formatting)

**Install jq (if needed):**
```bash
# Ubuntu/Debian
sudo apt-get install jq

# macOS
brew install jq
```

---

## Common Use Cases

### Testing Reporting Features
```bash
# Generate varied transactions
bash tests/generate_transactions.sh

# Check today's report
curl http://localhost:8080/api/report/hari-ini | jq

# Check date range report
curl "http://localhost:8080/api/report?start_date=2026-02-01&end_date=2026-02-28" | jq
```

### Demo / Presentation
```bash
# Quick demo with varied products
bash tests/quick_transactions.sh

# Or comprehensive demo
bash tests/generate_transactions.sh
```

### Load Testing
```bash
# Generate 50 random transactions
bash tests/smart_transactions.sh http://localhost:8080 50

# Generate 100 transactions
bash tests/smart_transactions.sh http://localhost:8080 100
```

---

## Notes

- All scripts use `sleep` delays to avoid overwhelming the server
- Failed transactions (e.g., insufficient stock) are reported but don't stop execution
- Scripts automatically show summary reports after completion
- Transaction IDs are sequential and auto-generated by the database

---

## Troubleshooting

**Problem:** Script shows "command not found: jq"
```bash
# Install jq first
sudo apt-get install jq  # Ubuntu/Debian
brew install jq          # macOS
```

**Problem:** Connection refused
```bash
# Make sure server is running
go run kasir-app.go

# Or check if server is on different port
curl http://localhost:8080/health
```

**Problem:** Insufficient stock errors
```bash
# Reset database or use smart_transactions.sh
# which avoids out-of-stock products
bash tests/smart_transactions.sh
```
